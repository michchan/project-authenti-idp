# Threat Model — TaskMaster User Authentication Flow

## Overview
- **Flow Name:** User Authentication and Session Management
- **Prepared By:** Security Expert
- **Reviewed By:** System Architect
- **Architecture Reference:** /docs/v1/architecture/system-architecture-1.0.md

## 1. Flow Description
Handles user registration, login, and session management for the TaskMaster application. Users can register with email/password, authenticate via OAuth providers (Google, GitHub), and maintain persistent sessions across devices. Involves PII and authentication credentials.

## 2. STRIDE Analysis

| STRIDE Category      | Threat Description | Potential Impact | Notes |
|----------------------|--------------------|------------------|-------|
| Spoofing             | Attacker impersonates legitimate user | High — unauthorized access to tasks/data | Implement MFA, device fingerprinting |
| Tampering            | Modify user roles or permissions in JWT | High — privilege escalation | Use signed JWTs with strong secrets |
| Repudiation          | User denies performing task actions | Medium — audit trail gaps | Comprehensive activity logging |
| Information Disclosure | User passwords or PII leaked in logs | High — GDPR/privacy violation | Hash passwords, mask PII in logs |
| Denial of Service    | Brute force login attempts | Medium — account lockouts, service degradation | Rate limiting, CAPTCHA |
| Elevation of Privilege | Standard user gains admin access | High — system compromise | RBAC validation, principle of least privilege |

## 3. DREAD Scoring

| Threat ID | Threat Summary                            | D  | R  | E  | A  | D  | Average | Risk Level |
|-----------|-------------------------------------------|----|----|----|----|----|---------|------------|
| T1        | Account takeover via credential stuffing  | 8  | 7  | 6  | 8  | 7  | 7.2     | High       |
| T2        | JWT token manipulation for privilege escalation | 9  | 6  | 7  | 7  | 8  | 7.4     | High       |
| T3        | User PII exposure in application logs     | 7  | 8  | 5  | 9  | 6  | 7.0     | High       |
| T4        | Brute force attack on login endpoint      | 5  | 6  | 8  | 7  | 4  | 6.0     | Medium     |
| T5        | Session fixation attacks                  | 6  | 5  | 6  | 6  | 5  | 5.6     | Medium     |

## 4. Mitigations
### Short-Term
- Implement bcrypt password hashing with salt
- Add rate limiting on authentication endpoints
- Enable secure session cookies (httpOnly, secure, sameSite)
- Implement JWT signature verification with RS256

### Long-Term
- Deploy multi-factor authentication (TOTP/SMS)
- Implement OAuth 2.0 PKCE flow for third-party auth
- Add device fingerprinting for suspicious login detection
- Deploy centralized audit logging system

## 5. Residual Risks
- Social engineering attacks targeting user credentials cannot be fully mitigated through technical controls; user education required.
- OAuth provider vulnerabilities are outside our direct control; monitoring for security advisories needed.